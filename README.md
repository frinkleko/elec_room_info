# Elec Room Info: SCUT å®¿èˆæ°´ç”µç©ºè°ƒä½™é¢æé†’

ğŸ¥µä½ è¿˜åœ¨å› åŠå¤œç©ºè°ƒæ¬ è´¹è¢«çƒ­é†’æ²¡åˆ°æœåŠ¡æ—¶é—´æ— æ³•å……å€¼æ‰€å›°æ‰°å—ï¼Ÿ

ğŸ˜£ä½ è¿˜åœ¨å› å¿˜å……ç”µè´¹çªç„¶åœç”µBosså¿«é€šå…³äº†å®éªŒè·‘åˆ°ä¸€åŠä¸»æœºå´å…³æœºäº†è€Œç—›è‹¦å—ï¼Ÿ

ğŸŒŸğŸŒŸä½ ä¸€å®šä¼šéœ€è¦çš„å®¿èˆæ°´ç”µç©ºè°ƒä½™é¢æé†’ç¨‹åºï¼å®æ—¶è·Ÿè¸ªä½™é¢ã€å¤šæ–¹å¼é¢„è­¦æ¨é€ï¼ˆå¾®ä¿¡ã€é‚®ä»¶ï¼‰ã€å……å€¼æ£€æµ‹ã€æ¯æ—¥ç”¨ç”µç»Ÿè®¡ï¼å†ä¹Ÿä¸ç”¨å®šæ—¶æ£€æŸ¥ä½™é¢å•¦ï¼

---

å¦‚æœä½ å¯¹æˆ‘ä»¬çš„å·¥ä½œæ„Ÿå…´è¶£ï¼Œæ¬¢è¿è”ç³»å¹¶åŠ å…¥åç»­å¼€å‘ï¼We Neeeed You!

## åŠŸèƒ½

### v0.3.0

- [x] Wxpusher å¾®ä¿¡æ¨é€

### v0.2.0

- [x] æ–°ä¸€å¡é€šç³»ç»Ÿé€‚é…
- [x] Pushplus å¾®ä¿¡æ¨é€

### v0.1.0

- [x] æ°´ç”µç©ºè°ƒä½™é¢è·Ÿè¸ª
- [x] ä½™é¢ä¸è¶³æŠ¥è­¦
- [x] å……å€¼æ£€æµ‹
- [x] é‚®ä»¶æ¶ˆæ¯è®¢é˜…

## å‡†å¤‡

- ä¸€å°é•¿æœŸè¿è¡Œçš„è®¡ç®—æœºï¼Œä¿æŒè”ç½‘å³å¯ï¼Œä¸éœ€è¦æ ¡å›­ç½‘
- å·²åœ¨ä¸€å¡é€šç•Œé¢ç»‘å®šç”µè´¹ã€ç©ºè°ƒã€æ°´è´¹çš„å®¿èˆæƒ…å†µ
- æŠ“åŒ…ä¼ä¸šå¾®ä¿¡ä¸€å¡é€šç½‘é¡µè¯·æ±‚ï¼Œæˆ–ä½¿ç”¨æµè§ˆå™¨F12æ‰“å¼€ä¸€å¡é€š H5 é¡µé¢æŠ“å– `cookies`ã€`bearer_token`

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šdockeréƒ¨ç½² (æˆ–ä½¿ç”¨ docker compose)

æ„å»ºdockeré•œåƒ

`docker build -t elec_room_info:latest .`

åˆ›å»ºè¿è¡Œç›®å½•

`mkdir project_dir && cd project_dir`

`mkdir data && cd data`

`mkdir configs && cd configs`

å°†é…ç½®æ–‡ä»¶ `sample_config.yaml` é‡å‘½åä¸º `config.yaml` å¹¶æ”¾äº`project_dir/data/configs`ç›®å½•ä¸‹ï¼ˆ`sample_config.ini` ä¸è¢«ç¨‹åºé»˜è®¤ä½¿ç”¨ï¼Œè¯·ä½¿ç”¨ `config.yaml`ï¼‰

è¿è¡Œdockerå®¹å™¨ï¼Œæ›¿æ¢å®¹å™¨æ˜ å°„è·¯å¾„

`docker run -v /path/to/elec_room_info/data:/app/data`

### æ–¹å¼äºŒï¼šéƒ¨ç½²æºä»£ç 

å¼€å‘åŸºäºpython 3.8ï¼Œè¯·ä½¿ç”¨python 3.8 ç‰ˆæœ¬ã€‚

`pip install -r requirement.txt`

ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶ï¼Œé¡»ç¼–è¾‘å®Œå–„åæ–¹å¯æ­£å¸¸è¿è¡Œï¼š

`python3 elec_room_info/utils/config/config_omega.py`

è¿è¡Œç¨‹åº

`python3 elec_room_info/main.py`

## Config æ–‡ä»¶

### 1. `addon` - åŠŸèƒ½æ¨¡å—å¼€å…³
| å‚æ•°                | ç±»å‹    | è¯´æ˜                     | é»˜è®¤å€¼  |
|---------------------|---------|--------------------------|---------|
| `balance_monitor`   | boolean | å¯ç”¨ä½™é¢ç›‘æ§åŠŸèƒ½         | `true`  |
| `deposit_monitor`   | boolean | å¯ç”¨å……å€¼ç›‘æ§åŠŸèƒ½         | `true`  |

---

### 2. `query` - æ•°æ®æŸ¥è¯¢é…ç½®
| å‚æ•°            | ç±»å‹   | è¯´æ˜                          | å¿…å¡«  |
|-----------------|--------|-------------------------------|-------|
| `bearer_token`  | string | Bearer Token       | æ˜¯    |
| `auth_link`     | string | è®¤è¯ URLï¼ˆæš‚è¢«å¼ƒç”¨ï¼‰                  | å¦    |
| `session_id`    | string | ä¼šè¯ ID  ï¼ˆæš‚è¢«å¼ƒç”¨ï¼‰                     | å¦    |

---

### 3. `record_csv` - æ•°æ®è®°å½•é…ç½®
| å‚æ•°                | ç±»å‹   | è¯´æ˜                          | é»˜è®¤å€¼       |
|---------------------|--------|-------------------------------|-------------|
| `csv_file_path`     | string | CSV æ•°æ®å­˜å‚¨è·¯å¾„ï¼ˆç›¸å¯¹è·¯å¾„ï¼‰  | `../data/records/query_data.csv` |
| `query_interval`    | int    | æ•°æ®æŸ¥è¯¢é—´éš”ï¼ˆç§’ï¼‰            | `1200` (20åˆ†é’Ÿ) |

---

### 4. `email` - é‚®ä»¶é€šçŸ¥é…ç½®
| å‚æ•°              | ç±»å‹    | è¯´æ˜                          | é»˜è®¤å€¼               |
|-------------------|---------|-------------------------------|---------------------|
| `enable`          | boolean | å¯ç”¨é‚®ä»¶é€šçŸ¥åŠŸèƒ½              | `false`            |
| `sender_email`    | string  | å‘ä»¶é‚®ç®±åœ°å€                  | `mail@example.com` |
| `sender_name`     | string  | å‘ä»¶äººåç§°                    | `root`             |
| `smtp_server`     | string  | SMTP æœåŠ¡å™¨åœ°å€               | `smtp.example.com` |
| `smtp_port`       | int     | SMTP æœåŠ¡å™¨ç«¯å£               | `587`              |
| `smtp_user`       | string  | SMTP ç™»å½•ç”¨æˆ·å               | `mail@example.com` |
| `smtp_password`   | string  | SMTP ç™»å½•å¯†ç                  | `<passwd>`         |

---

### 5. `pushplus` - pushplus å¾®ä¿¡æ¨é€é…ç½® (è¯¦ç»†å‚æ•°è¯·ç§»æ­¥[å®˜ç½‘æ–‡æ¡£](https://www.pushplus.plus/push2.html)äº†è§£)
| å‚æ•°            | ç±»å‹    | è¯´æ˜                          | ç¤ºä¾‹å€¼       |
|-----------------|---------|-------------------------------|-------------|
| `enable`        | boolean | å¯ç”¨ PushPlus æ¨é€            | `false`     |
| `token`         | string  | PushPlus ä»¤ç‰Œï¼ˆå®˜ç½‘è·å–ï¼‰     | `<token>`   |
| `topic`         | string  | æ¨é€åˆ†ç»„ IDï¼ˆå¯é€‰ï¼‰           | ç•™ç©º        |
| `channel`       | string  | æ¨é€æ¸ é“ï¼ˆé»˜è®¤å¾®ä¿¡ï¼‰          | `wechat`    |
| `max_attempts`  | int     | å¤±è´¥é‡è¯•æ¬¡æ•°                  | `3`         |

---

### 6. `wxpusher` - Wxpusher å¾®ä¿¡æ¨é€é…ç½®
| å‚æ•°            | ç±»å‹    | è¯´æ˜                          | ç¤ºä¾‹å€¼       |
|-----------------|---------|-------------------------------|-------------|
| `enable`        | boolean | å¯ç”¨ Wxpusher æ¨é€            | `false`     |
| `spt  `         | string  | Wxpusher SPT ä»¤ç‰Œï¼ˆ[è·å–é“¾æ¥](https://wxpusher.zjiecode.com/docs/#/?id=%e8%8e%b7%e5%8f%96spt)ï¼‰     | `<token>`   |
| `max_attempts`  | int     | å¤±è´¥é‡è¯•æ¬¡æ•°                  | `3`         |

---

### 7. `balance_monitor` - ä½™é¢ç›‘æ§é…ç½®
| å‚æ•°                          | ç±»å‹   | è¯´æ˜                          | ç¤ºä¾‹å€¼               |
|-------------------------------|--------|-------------------------------|---------------------|
| `to_emails`                   | string | å‘Šè­¦æ¥æ”¶é‚®ç®±ï¼ˆè‹¥é‚®ç®±æ¨é€æœªå¯ç”¨å°†è¢«å¿½ç•¥ï¼‰                  | `mail@example.com` |
| `threshold.water_balance`     | int    | æ°´è´¹ä½™é¢å‘Šè­¦é˜ˆå€¼ï¼ˆå•ä½ï¼šå…ƒï¼‰  | `5`                |
| `threshold.electricity_balance` | int  | ç”µè´¹ä½™é¢å‘Šè­¦é˜ˆå€¼ï¼ˆå•ä½ï¼šå…ƒï¼‰  | `5`                |
| `threshold.air_conditioner_balance` | int | ç©ºè°ƒä½™é¢å‘Šè­¦é˜ˆå€¼ï¼ˆå•ä½ï¼šå…ƒï¼‰ | `8`                |

---

## æ³¨æ„äº‹é¡¹
1. æš‚ä¸æ”¯æŒç¯å¢ƒå˜é‡ä¼ å‚
2. æ–‡ä»¶è·¯å¾„éœ€ç¡®ä¿ç¨‹åºæœ‰è¯»å†™æƒé™

--- 

## Todos

- [ ] ç”¨ç”µæ—¥æŠ¥
- [ ] å‰©ä½™æ°´ç”µæ—¶é—´ä¼°è®¡
- [ ] åç«¯api
- [ ] æä¾›å¾®ä¿¡å°ç¨‹åºæœåŠ¡
- [ ] å¤§å­¦åŸã€äº”å±±æ ¡åŒºé€‚é…
